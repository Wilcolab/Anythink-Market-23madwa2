function toSnakeCase(text) {
  if (typeof text !== "string") {
    throw new Error("Input must be a string");
  }

  return text
    .trim()
    .replace(/([a-z])([A-Z])/g, "$1_$2")   
    .replace(/[\s\-]+/g, "_")              
    .replace(/__+/g, "_")                 
    .toLowerCase();
}
